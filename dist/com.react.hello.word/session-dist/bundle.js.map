{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/session-src/index.js","webpack:///./src/session-src/src/ScriptLoader.js","webpack:///./src/session-src/src/Session.js","webpack:///./src/session-src/src/managers/DataManagers.js","webpack:///./src/session-src/src/managers/LogManager.js","webpack:///external \"events\""],"names":["window","session","ScriptLoader","EvalScript_ErrMessage","cs","CSInterface","fileName","extensionRoot","getSystemPath","SystemPath","EXTENSION","evalScript","functionName","params","params_string","JSON","stringify","eval_string","that","Promise","resolve","reject","callback","eval_res","toLowerCase","indexOf","log","createScriptError","reason","data","val","console","name","_cs","scriptLoader","Session","_managers","DataManagers","init","loadJSX","test","obj","then","res","options","folderPath","isFlattenChecked","isInfoChecked","isInspectVisibleChecked","isMasksChecked","isTexturesChecked","isMeaningfulNamesChecked","isHierarchicalChecked","pluginData","destinationFolder","exportInfoJson","inspectOnlyVisibleLayers","exportMasks","exportTextures","flatten","namePrefix","undefined","parse","catch","err","_manager_log","LogManager","_logs","call","arguments","addRawLog","push"],"mappings":";QAAA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;;QAEA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;;;QAGA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;QACA,0CAA0C,gCAAgC;QAC1E;QACA;;QAEA;QACA;QACA;QACA,wDAAwD,kBAAkB;QAC1E;QACA,iDAAiD,cAAc;QAC/D;;QAEA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA,yCAAyC,iCAAiC;QAC1E,gHAAgH,mBAAmB,EAAE;QACrI;QACA;;QAEA;QACA;QACA;QACA,2BAA2B,0BAA0B,EAAE;QACvD,iCAAiC,eAAe;QAChD;QACA;QACA;;QAEA;QACA,sDAAsD,+DAA+D;;QAErH;QACA;;;QAGA;QACA;;;;;;;;;;;;;;;AC9EA;;;;;;AAEAA,OAAOC,OAAP,GAAiBA,iBAAjB,C,CANA;;;;;;;;;;;;;;;;;;;;;;;;ACAA;;;;AAIA;;;IAGMC,Y;AAGF,4BAAc;AAAA;;AAAA,aAFdC,qBAEc,GAFU,mBAEV;;AACV,aAAKC,EAAL,GAAU,IAAIC,WAAJ,EAAV;AACH;;;;;;AAUD;;;;;;;gCAOQC,Q,EAAU;AACd,gBAAIF,KAAK,KAAKA,EAAd;AACA,gBAAIG,gBAAgBH,GAAGI,aAAH,CAAiBC,WAAWC,SAA5B,IAAyC,QAA7D;;AAEAN,eAAGO,UAAH,CAAc,iBAAiBJ,aAAjB,GAAiCD,QAAjC,GAA4C,IAA1D;AACH;;AAED;;;;;;;;;;mCAOWM,Y,EAAcC,M,EAAQ;AAC7B,gBAAIC,gBAAgBD,SAASE,KAAKC,SAAL,CAAeH,MAAf,CAAT,GAAkC,EAAtD;AACA,gBAAII,cAAiBL,YAAjB,UAAkCE,aAAlC,OAAJ;AACA,gBAAII,OAAO,IAAX;;AAEA,mBAAO,IAAIC,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;;AAEpC,oBAAIC,WAAW,SAAXA,QAAW,CAASC,QAAT,EAAmB;AAC9B;AACA,wBAAG,OAAOA,QAAP,KAAoB,QAAvB,EAAiC;AAC7B;AACA,4BAAGA,SAASC,WAAT,GAAuBC,OAAvB,CAA+B,OAA/B,KAA2C,CAAC,CAA/C,EAAkD;AAC9CP,iCAAKQ,GAAL,CAAS,UAAT;AACAL,mCAAOH,KAAKS,iBAAL,CAAuBJ,QAAvB,CAAP;;AAEA;AACH;AACJ;;AAEDL,yBAAKQ,GAAL,CAAS,cAAT;;AAEAN,4BAAQG,QAAR;;AAEA;AACH,iBAjBD;;AAmBAL,qBAAKd,EAAL,CAAQO,UAAR,CAAmBM,WAAnB,EAAgCK,QAAhC;AACH,aAtBM,CAAP;AAwBH;;;0CAEiBM,M,EAAQC,I,EAAM;AAC5B,mBAAO,EAACD,cAAD,EAASC,UAAT,EAAP;AACH;;AAED;;;;;;;;4BAKIC,G,EAAK;AACLC,oBAAQL,GAAR,CAAe,KAAKM,IAApB,SAA4BF,GAA5B;AACH;;;4BAvEQ;AACL,mBAAO,KAAKG,GAAZ;AACH,S;0BAEMH,G,EAAK;AACR,iBAAKG,GAAL,GAAWH,GAAX;AACH;;;4BAmEU;AACP,mBAAO,iBAAP;AACH;;;;;;AAIL,IAAII,eAAe,IAAIhC,YAAJ,EAAnB;;kBAEegC,Y;;;;;;;;;;;;;;;;;;qjBC/Ff;;;;AAIA;;;;AACA;;;;AACA;;;;;;;;AACA;;;;;IAKMC,O;AAIF,uBAAc;AAAA;;AAAA,aAFdC,SAEc,GAFF,IAAIC,sBAAJ,EAEE;;AACV;;AAEA,aAAKC,IAAL;AACH;;AAED;;;;;;;;+BAIO;AACH;AACA,iBAAKF,SAAL,CAAeE,IAAf;AACA,iBAAKZ,GAAL,CAAS,uBAAT;AACA;AACA,iBAAKA,GAAL,CAAS,2BAAT;AACAQ,mCAAaK,OAAb,CAAqB,UAArB;;AAEA;AACA,iBAAKC,IAAL;AACA;AACA;;AAEA,iBAAKd,GAAL,CAAS,mBAAT;AACH;;AAGD;;;;;;;;;;AASA;;;;uCAIe;AACX,mBAAOQ,sBAAP;AACH;;AAED;;;;;;;+BAIO;AAAA;;AACH,gBAAIO,MAAM;AACNT,sBAAM;AADA,aAAV;;AAIAE,mCAAavB,UAAb,CAAwB,WAAxB,EAAqC8B,GAArC,EAA0CC,IAA1C,CAA+C,UAACC,GAAD,EAAS;AACpD,sBAAKjB,GAAL,CAAS,eAAeiB,GAAxB;AACH,aAFD;AAGH;;AAED;;;;;;;;;;qCAOaC,O,EAAS;AAAA,gBACVC,UADU,GAIyCD,OAJzC,CACVC,UADU;AAAA,gBACEC,gBADF,GAIyCF,OAJzC,CACEE,gBADF;AAAA,gBAEVC,aAFU,GAIyCH,OAJzC,CAEVG,aAFU;AAAA,gBAEKC,uBAFL,GAIyCJ,OAJzC,CAEKI,uBAFL;AAAA,gBAGVC,cAHU,GAIyCL,OAJzC,CAGVK,cAHU;AAAA,gBAGMC,iBAHN,GAIyCN,OAJzC,CAGMM,iBAHN;AAAA,gBAIVC,wBAJU,GAIyCP,OAJzC,CAIVO,wBAJU;AAAA,gBAIgBC,qBAJhB,GAIyCR,OAJzC,CAIgBQ,qBAJhB;;AAMlB;;AACA,gBAAMC,aAAa;AACfC,mCAAmBT,UADJ;AAEfU,gCAAgBR,aAFD;AAGfS,0CAA0BR,uBAHX;AAIfS,6BAAaR,cAJE;AAKfS,gCAAgBR,iBALD;AAMfS,yBAAS,CAACP,qBANK;AAOfQ,4BAAYT,2BAA2B,OAA3B,GAAqCU;AAPlC,aAAnB;;AAUA,gBAAI3C,OAAO,IAAX;;AAEA,mBAAO,IAAIC,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;;AAEpCa,uCAAavB,UAAb,CAAwB,wBAAxB,EAAkD0C,UAAlD,EACaX,IADb,CACkB,UAACC,GAAD,EAAS;AACXvB,4BAAQL,KAAK+C,KAAL,CAAWnB,GAAX,CAAR;AACH,iBAHb,EAIaoB,KAJb,CAImB,eAAO;AACV1C,2BAAO2C,GAAP;AACH,iBANb;AAQH,aAVM,CAAP;AAYH;;AAED;;;;;;;;4BAKIlC,G,EAAK;AACLC,oBAAQL,GAAR,CAAe,KAAKM,IAApB,SAA4BF,GAA5B;AACH;;;4BAzEc;AACX,mBAAO,KAAKM,SAAZ;AACH;;;4BAyEU;AACP,mBAAO,YAAP;AACH;;;;;;AAIL,IAAInC,UAAU,IAAIkC,OAAJ,EAAd;;kBAEelC,O;;;;;;;;;;;;;;;;;;qjBCnIf;;;;AAIA;;;;;;;;IAEqBoC,Y;AAGjB,4BAAc;AAAA;;AAAA,aAFd4B,YAEc,GAFCJ,SAED;AAEb;;;;+BAEM;AACH,iBAAKI,YAAL,GAAoB,IAAIC,oBAAJ,EAApB;;AAEA,iBAAKD,YAAL,CAAkB3B,IAAlB;AACH;;AAED;;;;;;;;4BAKU;AACN,mBAAO,KAAK2B,YAAZ;AACH;;;;;;kBApBgB5B,Y;;;;;;;;;;;;;;;;;;;;;;ACNrB;;;;AAKA;;;;IAIqB6B,U;AAGjB,0BAAc;AAAA;;AAAA,aAFdC,KAEc,GAFN,EAEM;AAEb;;;;+BAEM;AACH,iBAAKzC,GAAL,CAAS,YAAT;;AAEA,gBAAIA,MAAMK,QAAQL,GAAlB;;AAEA,gBAAGK,YAAY8B,SAAf,EACI;AACJ,gBAAI3C,OAAO,IAAX;AACA;AACAa,oBAAQL,GAAR,GAAc,YAAY;AACtB;AACA;AACA;AACAA,oBAAI0C,IAAJ,aAAS,IAAT,oCAAkBC,SAAlB;AACA;AACAnD,qBAAKoD,SAAL,aAAkBD,SAAlB;AACH,aAPD;AASH;;AAED;;;;;;;;;kCAMUvC,G,EAAK;AACX,iBAAKqC,KAAL,CAAWI,IAAX,CAAgBzC,GAAhB;AACH;;;4BAUGA,G,EAAK;AACL,mBAAU,KAAKE,IAAf,SAAuBF,GAAvB;AACH;;;4BAVa;AACV,mBAAO,KAAKqC,KAAZ;AACH;;;4BAEU;AACP,mBAAO,eAAP;AACH;;;;;;kBA3CgBD,U;;;;;;;;;;;ACTrB,mC","file":"bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/session-src/index.js\");\n","/**\r\n * @author Tomer Riko Shalev\r\n */\r\n\r\nimport session from './src/Session.js'\r\n\r\nwindow.session = session\r\n","/**\r\n * @author Tomer Riko Shalev\r\n */\r\n\r\n/**\r\n * load jsx scripts dynamically\r\n */\r\nclass ScriptLoader {\r\n    EvalScript_ErrMessage = \"EvalScript error.\"\r\n\r\n    constructor() {\r\n        this.cs = new CSInterface()\r\n    }\r\n\r\n    get cs() {\r\n        return this._cs\r\n    }\r\n\r\n    set cs(val) {\r\n        this._cs = val\r\n    }\r\n\r\n    /**\r\n     * loadJSX - load a jsx file dynamically, this\r\n     * will also load all of it's includes which is desirable\r\n     *\r\n     * @param  {type} fileName the file name\r\n     * @return {type}          description\r\n     */\r\n    loadJSX(fileName) {\r\n        var cs = this.cs\r\n        var extensionRoot = cs.getSystemPath(SystemPath.EXTENSION) + \"/host/\";\r\n\r\n        cs.evalScript('$.evalFile(\"' + extensionRoot + fileName + '\")');\r\n    }\r\n\r\n    /**\r\n     * evalScript - evaluate a JSX script\r\n     *\r\n     * @param  {type} functionName the string name of the function to invoke\r\n     * @param  {type} params the params object\r\n     * @return {Promise} a promise\r\n     */\r\n    evalScript(functionName, params) {\r\n        var params_string = params ? JSON.stringify(params) : ''\r\n        var eval_string = `${functionName}('${params_string}')`\r\n        var that = this\r\n\r\n        return new Promise((resolve, reject) => {\r\n\r\n            var callback = function(eval_res) {\r\n                // console.log('weird' + eval_res)\r\n                if(typeof eval_res === 'string') {\r\n                    // console.log(eval_res)\r\n                    if(eval_res.toLowerCase().indexOf('error') != -1) {\r\n                        that.log('err eval')\r\n                        reject(that.createScriptError(eval_res))\r\n\r\n                        return\r\n                    }\r\n                }\r\n\r\n                that.log('success eval')\r\n\r\n                resolve(eval_res)\r\n\r\n                return\r\n            }\r\n\r\n            that.cs.evalScript(eval_string, callback)\r\n        })\r\n\r\n    }\r\n\r\n    createScriptError(reason, data) {\r\n        return {reason, data}\r\n    }\r\n\r\n    /**\r\n     * log some info with session prefix\r\n     *\r\n     * @param  {string} val what to log\r\n     */\r\n    log(val) {\r\n        console.log(`${this.name} ${val}`)\r\n    }\r\n\r\n    get name() {\r\n        return 'ScriptLoader:: '\r\n    }\r\n\r\n}\r\n\r\nvar scriptLoader = new ScriptLoader()\r\n\r\nexport default scriptLoader\r\n","/**\r\n * @author Tomer Riko Shalev\r\n */\r\n\r\nimport EventEmitter from 'events'\r\nimport scriptLoader from './ScriptLoader'\r\nimport DataManagers from './managers/DataManagers.js'\r\n/**\r\n * the main plugin session. This can enter the node modules as\r\n * well as the host\r\n *\r\n */\r\nclass Session {\r\n\r\n    _managers = new DataManagers()\r\n\r\n    constructor() {\r\n        //super()\r\n\r\n        this.init()\r\n    }\r\n\r\n    /**\r\n     * init - session\r\n     *\r\n     */\r\n    init() {\r\n        // init before everything so I can intercept console.log\r\n        this._managers.init()\r\n        this.log('session is initing...')\r\n        // load jsx file dynamically\r\n        this.log('loading the main jsx file')\r\n        scriptLoader.loadJSX('main.jsx')\r\n\r\n        // some testing\r\n        this.test()\r\n        // var fs = require('fs-extra')\r\n        //console.log(fs)\r\n\r\n        this.log('session is inited')\r\n    }\r\n\r\n\r\n    /**\r\n     * get data managers\r\n     *\r\n     * @return {type}  description\r\n     */\r\n    get managers() {\r\n        return this._managers\r\n    }\r\n\r\n    /**\r\n     * scriptLoader - get the script loader\r\n     *\r\n     */\r\n    scriptLoader() {\r\n        return scriptLoader\r\n    }\r\n\r\n    /**\r\n     * test - let's test things\r\n     *\r\n     */\r\n    test() {\r\n        var obj = {\r\n            name: 'tomer'\r\n        }\r\n\r\n        scriptLoader.evalScript('test_host', obj).then((res) => {\r\n            this.log('result is ' + res)\r\n        })\r\n    }\r\n\r\n    /**\r\n     * invoke the plugin\r\n     *\r\n     * @param  {{textures:boolean, masks:boolean, info: boolean, flatten:boolean}} options for plugin\r\n     *\r\n     * @return {object} describes how well the execution of plugin was\r\n     */\r\n    invokePlugin(options) {\r\n        const { folderPath, isFlattenChecked,\r\n                isInfoChecked, isInspectVisibleChecked,\r\n                isMasksChecked, isTexturesChecked,\r\n                isMeaningfulNamesChecked, isHierarchicalChecked} = options\r\n\r\n        // i reparse everything to detect failures\r\n        const pluginData = {\r\n            destinationFolder: folderPath,\r\n            exportInfoJson: isInfoChecked,\r\n            inspectOnlyVisibleLayers: isInspectVisibleChecked,\r\n            exportMasks: isMasksChecked,\r\n            exportTextures: isTexturesChecked,\r\n            flatten: !isHierarchicalChecked,\r\n            namePrefix: isMeaningfulNamesChecked ? 'layer' : undefined\r\n        }\r\n\r\n        var that = this\r\n\r\n        return new Promise((resolve, reject) => {\r\n\r\n            scriptLoader.evalScript('invoke_document_worker', pluginData)\r\n                        .then((res) => {\r\n                            resolve(JSON.parse(res))\r\n                        })\r\n                        .catch(err => {\r\n                            reject(err)\r\n                        })\r\n\r\n        })\r\n\r\n    }\r\n\r\n    /**\r\n     * log some info with session prefix\r\n     *\r\n     * @param  {string} val what to log\r\n     */\r\n    log(val) {\r\n        console.log(`${this.name} ${val}`)\r\n    }\r\n\r\n    get name() {\r\n        return 'Session:: '\r\n    }\r\n\r\n}\r\n\r\nvar session = new Session()\r\n\r\nexport default session\r\n","/**\r\n * @author Tomer Riko Shalev\r\n */\r\n\r\nimport LogManager from './LogManager.js'\r\n\r\nexport default class DataManagers {\r\n    _manager_log = undefined\r\n\r\n    constructor() {\r\n\r\n    }\r\n\r\n    init() {\r\n        this._manager_log = new LogManager()\r\n\r\n        this._manager_log.init()\r\n    }\r\n\r\n    /**\r\n     * get log - the log manager\r\n     *\r\n     * @return {LogManager} the log manager\r\n     */\r\n    get log() {\r\n        return this._manager_log\r\n    }\r\n\r\n}\r\n","/**\r\n * @author Tomer Riko Shalev\r\n */\r\n\r\n\r\n/**\r\n * log management\r\n *\r\n */\r\nexport default class LogManager {\r\n    _logs = []\r\n\r\n    constructor() {\r\n\r\n    }\r\n\r\n    init() {\r\n        this.log('initing...')\r\n\r\n        var log = console.log\r\n\r\n        if(console === undefined)\r\n            return\r\n        var that = this\r\n        // override the console.log method\r\n        console.log = function () {\r\n            // log.call(this, 'My Console!!!')\r\n            // log.apply(this, Array.prototype.slice.call(arguments))\r\n            // retain older console.log functionality\r\n            log.call(this, ...arguments)\r\n            // save the log internally\r\n            that.addRawLog(...arguments)\r\n        }\r\n\r\n    }\r\n\r\n    /**\r\n     * addLog - collect log\r\n     *\r\n     * @param  {Object} val anything\r\n     *\r\n     */\r\n    addRawLog(val) {\r\n        this._logs.push(val)\r\n    }\r\n\r\n    get rawLogs() {\r\n        return this._logs\r\n    }\r\n\r\n    get name() {\r\n        return 'LogManager:: '\r\n    }\r\n\r\n    log(val) {\r\n        return `${this.name} ${val}`\r\n    }\r\n}\r\n","module.exports = require(\"events\");"],"sourceRoot":""}